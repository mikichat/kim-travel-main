ì´ ì‘ì—…ì„ êµ¬í˜„í•˜ê¸°ì— ê°€ì¥ ì¢‹ì€ ì–¸ì–´ëŠ” \*\*Python(íŒŒì´ì¬)\*\*ì…ë‹ˆë‹¤.

ê·¸ ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.

  * **ê°•ë ¥í•œ ìƒíƒœê³„:** ì›¹ ì„œë²„(Flask), Excel ì²˜ë¦¬(Pandas), Gemini API ì—°ë™(ê³µì‹ SDK), SQLite3(ê¸°ë³¸ ë‚´ì¥)ì— í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë§¤ìš° ì˜ ê°–ì¶°ì ¸ ìˆìŠµë‹ˆë‹¤.
  * **ê°œë°œ ì†ë„:** ë¬¸ë²•ì´ ê°„ê²°í•˜ê³  ì§ê´€ì ì´ì–´ì„œ ë¹ ë¥´ê²Œ í”„ë¡œí† íƒ€ì…ì„ ë§Œë“¤ê³  ì™„ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  * **AI/ë°ì´í„° ì¹œí™”ì :** Gemini APIë¥¼ í˜¸ì¶œí•˜ê³  ë°˜í™˜ëœ ë°ì´í„°(ì£¼ë¡œ JSON)ë¥¼ íŒŒì‹±í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ì¼ë ¨ì˜ ê³¼ì •ì— ê°€ì¥ ìµœì í™”ëœ ì–¸ì–´ì…ë‹ˆë‹¤.

Node.js(JavaScript)ë„ ì¢‹ì€ ëŒ€ì•ˆì´ ë  ìˆ˜ ìˆì§€ë§Œ, Excel íŒŒì¼ ì²˜ë¦¬ì™€ ë°ì´í„° ê°€ê³µ ì¸¡ë©´ì—ì„œ Python(Pandas ë¼ì´ë¸ŒëŸ¬ë¦¬)ì´ ì¢€ ë” í¸ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

-----

## ğŸ’» ê°œë°œ ë‹¨ê³„ë³„ ê°€ì´ë“œ (Python, Flask ê¸°ì¤€)

ì „ì²´ì ì¸ íë¦„ì€ \*\*[ì›¹(HTML) â†’ Flask ì„œë²„(Python) â†’ Gemini API â†’ SQLite3]\*\*ê°€ ë©ë‹ˆë‹¤.

### 1ë‹¨ê³„: ê°œë°œ í™˜ê²½ ì„¤ì • ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

ë¨¼ì € íŒŒì´ì¬ ê°€ìƒ í™˜ê²½ì„ ë§Œë“¤ê³  í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•©ë‹ˆë‹¤.

```bash
# ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
pip install flask
pip install google-generativeai
pip install pandas  # Excel íŒŒì¼ì„ ì½ê¸° ìœ„í•´ ì‚¬ìš©
pip install python-dotenv # API í‚¤ ê´€ë¦¬ë¥¼ ìœ„í•´
```

### 2ë‹¨ê³„: SQLite3 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

ì¼ì • ë°ì´í„°ë¥¼ ì €ì¥í•  í…Œì´ë¸”ì„ ë¯¸ë¦¬ ì •ì˜í•©ë‹ˆë‹¤. `init_db.py` ê°™ì€ íŒŒì¼ì„ ë§Œë“¤ì–´ í•œ ë²ˆ ì‹¤í–‰í•´ ì¤ë‹ˆë‹¤.

**`init_db.py`**

```python
import sqlite3

conn = sqlite3.connect('schedule.db')
cursor = conn.cursor()

# 'schedules' í…Œì´ë¸” ìƒì„±
cursor.execute('''
CREATE TABLE IF NOT EXISTS schedules (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    event_name TEXT NOT NULL,
    event_date TEXT,
    location TEXT,
    description TEXT
)
''')

conn.commit()
conn.close()
print("ë°ì´í„°ë² ì´ìŠ¤ ë° í…Œì´ë¸” ìƒì„± ì™„ë£Œ.")
```

### 3ë‹¨ê³„: ì›¹ í”„ëŸ°íŠ¸ì—”ë“œ (HTML) ìƒì„±

ì‚¬ìš©ìê°€ Excel íŒŒì¼ì„ ì—…ë¡œë“œí•  ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ HTML í¼ì„ ë§Œë“­ë‹ˆë‹¤. (`templates/index.html`ë¡œ ì €ì¥)

**`templates/index.html`**

```html
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì¼ì •í‘œ ì—…ë¡œë“œ</title>
</head>
<body>
    <h2>ì¼ì •í‘œ (.xlsx) íŒŒì¼ ì—…ë¡œë“œ</h2>
    <form action="/upload" method="post" enctype="multipart/form-data">
        <input type="file" name="schedule_file" accept=".xlsx" required>
        <button type="submit">ì—…ë¡œë“œ ë° ì¶”ì¶œ</button>
    </form>
</body>
</html>
```

### 4ë‹¨ê³„: Flask ë°±ì—”ë“œ ì„œë²„ êµ¬ì¶•

íŒŒì¼ ì—…ë¡œë“œë¥¼ ì²˜ë¦¬í•˜ê³ , Gemini APIë¥¼ í˜¸ì¶œí•˜ë©°, DBì— ì €ì¥í•˜ëŠ” í•µì‹¬ ë¡œì§ì…ë‹ˆë‹¤.

**`app.py`**

````python
import os
import json
import sqlite3
import pandas as pd
import google.generativeai as genai
from flask import Flask, request, render_template, redirect, url_for
from werkzeug.utils import secure_filename
from dotenv import load_dotenv

load_dotenv() # .env íŒŒì¼ì—ì„œ í™˜ê²½ ë³€ìˆ˜ ë¡œë“œ

app = Flask(__name__)
app.config['UPLOAD_FOLDER'] = 'uploads'
os.makedirs(app.config['UPLOAD_FOLDER'], exist_ok=True)

# Google Gemini API í‚¤ ì„¤ì •
genai.configure(api_key=os.getenv("GEMINI_API_KEY"))

# --- 5ë‹¨ê³„: Gemini APIë¡œ ë°ì´í„° ì¶”ì¶œ (í•¨ìˆ˜) ---
def extract_schedule_from_excel(file_path):
    # 1. Pandasë¡œ Excel ë°ì´í„°ë¥¼ í…ìŠ¤íŠ¸(CSV í˜•íƒœ)ë¡œ ë³€í™˜
    #    Geminiê°€ Excel ë°”ì´ë„ˆë¦¬ë³´ë‹¤ í…ìŠ¤íŠ¸ë¥¼ ë” ì˜ ì´í•´í•©ë‹ˆë‹¤.
    try:
        df = pd.read_excel(file_path)
        data_string = df.to_csv(index=False)
    except Exception as e:
        print(f"Excel íŒŒì¼ ì½ê¸° ì˜¤ë¥˜: {e}")
        return None

    # 2. Gemini ëª¨ë¸ ë° í”„ë¡¬í”„íŠ¸ ì„¤ì •
    model = genai.GenerativeModel('gemini-1.5-flash') # ë˜ëŠ” 1.5-pro
    
    prompt = f"""
    ë‹¤ìŒì€ Excel ì¼ì •í‘œì—ì„œ ì¶”ì¶œí•œ CSV ë°ì´í„°ì…ë‹ˆë‹¤.
    ì´ ë°ì´í„°ì—ì„œ ì¼ì • ì •ë³´ë¥¼ ì¶”ì¶œí•˜ì—¬ JSON ë°°ì—´ í˜•íƒœë¡œ ë°˜í™˜í•´ ì£¼ì„¸ìš”.
    ê° í•­ëª©ì€ 'event_name', 'event_date', 'location', 'description' í‚¤ë¥¼ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤.
    ë‚ ì§œ í˜•ì‹ì€ 'YYYY-MM-DD'ë¡œ í†µì¼í•˜ê³ , ì•Œ ìˆ˜ ì—†ëŠ” ê°’ì€ nullë¡œ ì²˜ë¦¬í•´ ì£¼ì„¸ìš”.

    [ë°ì´í„°]
    {data_string}
    """
    
    try:
        response = model.generate_content(prompt)
        # Geminiê°€ ë°˜í™˜í•œ í…ìŠ¤íŠ¸ì—ì„œ JSON ë¶€ë¶„ë§Œ ê¹”ë”í•˜ê²Œ ì¶”ì¶œ
        json_text = response.text.strip().lstrip("```json").rstrip("```")
        return json.loads(json_text)
    except Exception as e:
        print(f"Gemini API ì˜¤ë¥˜: {e}")
        print(f"ì‘ë‹µ í…ìŠ¤íŠ¸: {response.text}")
        return None

# --- 6ë‹¨ê³„: SQLite3ì— ë°ì´í„° ì €ì¥ (í•¨ìˆ˜) ---
def save_to_sqlite(schedule_data):
    conn = sqlite3.connect('schedule.db')
    cursor = conn.cursor()
    
    count = 0
    for item in schedule_data:
        try:
            cursor.execute(
                "INSERT INTO schedules (event_name, event_date, location, description) VALUES (?, ?, ?, ?)",
                (
                    item.get('event_name'),
                    item.get('event_date'),
                    item.get('location'),
                    item.get('description')
                )
            )
            count += 1
        except Exception as e:
            print(f"DB ì €ì¥ ì˜¤ë¥˜: {e} - ë°ì´í„°: {item}")
            
    conn.commit()
    conn.close()
    return count

# --- ê¸°ë³¸ ë¼ìš°íŠ¸ ---
@app.route('/')
def index():
    return render_template('index.html')

# --- íŒŒì¼ ì—…ë¡œë“œ ë° ì²˜ë¦¬ ë¼ìš°íŠ¸ ---
@app.route('/upload', methods=['POST'])
def upload_file():
    if 'schedule_file' not in request.files:
        return "íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.", 400
    
    file = request.files['schedule_file']
    if file.filename == '':
        return "íŒŒì¼ì´ ì„ íƒë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.", 400
    
    if file and file.filename.endswith('.xlsx'):
        filename = secure_filename(file.filename)
        file_path = os.path.join(app.config['UPLOAD_FOLDER'], filename)
        file.save(file_path)
        
        # 5ë‹¨ê³„: ë°ì´í„° ì¶”ì¶œ
        print(f"{file_path}ì—ì„œ ë°ì´í„° ì¶”ì¶œ ì‹œë„...")
        extracted_data = extract_schedule_from_excel(file_path)
        
        if extracted_data:
            # 6ë‹¨ê³„: ë°ì´í„° ì €ì¥
            print(f"Geminiê°€ {len(extracted_data)}ê°œì˜ í•­ëª© ì¶”ì¶œí•¨.")
            saved_count = save_to_sqlite(extracted_data)
            return f"ì„±ê³µ: ì´ {len(extracted_data)}ê°œì˜ ì¼ì • ì¤‘ {saved_count}ê°œê°€ DBì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤."
        else:
            return "ë°ì´í„° ì¶”ì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", 500
            
    return "ì˜ëª»ëœ íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤. (xlsxë§Œ ê°€ëŠ¥)", 400

if __name__ == '__main__':
    app.run(debug=True)
````

### 5ë‹¨ê³„: ì‹¤í–‰ ë° í…ŒìŠ¤íŠ¸

1.  `.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  Gemini API í‚¤ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
    **`.env`**
    ```
    GEMINI_API_KEY=ì—¬ê¸°ì—_ë°œê¸‰ë°›ì€_API_í‚¤ë¥¼_ì…ë ¥í•˜ì„¸ìš”
    ```
2.  (ìµœì´ˆ 1íšŒ) DB í…Œì´ë¸”ì„ ìƒì„±í•©ë‹ˆë‹¤.
    ```bash
    python init_db.py
    ```
3.  Flask ì„œë²„ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
    ```bash
    flask run
    ```
4.  ë¸Œë¼ìš°ì €ì—ì„œ `http://127.0.0.1:5000`ì— ì ‘ì†í•˜ì—¬ `ì¼ì •í‘œ.xlsx` íŒŒì¼ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.
5.  `schedule.db` íŒŒì¼ì— ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

-----

## ğŸ’¡ ì£¼ìš” ê³ ë ¤ì‚¬í•­

  * **Gemini í”„ë¡¬í”„íŠ¸:** ì¼ì • ì¶”ì¶œì˜ ì„±ê³µë¥ ì€ `extract_schedule_from_excel` í•¨ìˆ˜ ì•ˆì˜ **í”„ë¡¬í”„íŠ¸**ì— í¬ê²Œ ì¢Œìš°ë©ë‹ˆë‹¤. Excel íŒŒì¼ì˜ í˜•ì‹ì´ ë³µì¡í•˜ë‹¤ë©´(ì˜ˆ: ë³‘í•©ëœ ì…€, ì—¬ëŸ¬ ì‹œíŠ¸), í”„ë¡¬í”„íŠ¸ë¥¼ ë” êµ¬ì²´ì ìœ¼ë¡œ ì‘ì„±í•´ì•¼ í•©ë‹ˆë‹¤.
  * **Excel ë°ì´í„° ì „ì²˜ë¦¬:** ìœ„ ì˜ˆì œì—ì„œëŠ” `pandas`ë¥¼ ì‚¬ìš©í•´ Excelì„ CSV í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ Geminiì—ê²Œ ì „ë‹¬í–ˆìŠµë‹ˆë‹¤. ë§Œì•½ Excel íŒŒì¼ ìì²´(ë°”ì´ë„ˆë¦¬)ë¥¼ Gemini ìµœì‹  ëª¨ë¸(1.5 Pro ë“±)ì— ì§ì ‘ ì „ë‹¬í•˜ì—¬ ë¶„ì„í•˜ê²Œ í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì¼ë°˜ì ìœ¼ë¡œëŠ” ì •í˜• ë°ì´í„°ë¥¼ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ ì£¼ëŠ” ê²ƒì´ ë” ì•ˆì •ì ì¸ ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
  * **ë°ì´í„° ê²€ì¦:** Geminiê°€ ë°˜í™˜í•œ JSON ë°ì´í„°ê°€ í•­ìƒ ì™„ë²½í•œ í˜•ì‹(ì˜ˆ: ë‚ ì§œ í¬ë§·)ì´ë¼ê³  ë³´ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. DBì— ì €ì¥í•˜ê¸° ì „ì— ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬(Validation) ë¡œì§ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
  * **ë³´ì•ˆ:** ì‹¤ì œ ì„œë¹„ìŠ¤ë¡œ ìš´ì˜í•  ê²½ìš°, ì—…ë¡œë“œë˜ëŠ” íŒŒì¼ì˜ í™•ì¥ì, í¬ê¸° ë“±ì„ ì—„ê²©í•˜ê²Œ ì œí•œí•´ì•¼ í•©ë‹ˆë‹¤.

ì´ ê¸°ë³¸ êµ¬ì¡°ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•„ìš”í•œ ê¸°ëŠ¥ë“¤ì„ ì¶”ê°€í•´ë‚˜ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
